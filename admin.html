<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gallery Control Panel</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { background: #f8fbff; font-family: 'Raleway', sans-serif; }
    .admin-container { max-width: 700px; margin: 40px auto; background: #fff; border-radius: 14px; box-shadow: 0 2px 16px #b6e0fe55; padding: 2.5rem 2rem; }
    h1 { color: #134b70; text-align: center; margin-bottom: 2rem; }
    .upload-form { display: flex; gap: 1rem; margin-bottom: 2.5rem; }
    .upload-form input[type="file"] { flex: 1; }
    .upload-form button { background: #ff9800; color: #fff; border: none; border-radius: 8px; padding: 0.7rem 2rem; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: background 0.18s; }
    .upload-form button:hover { background: #134b70; }
    .gallery-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 18px; }
    .gallery-item { background: #f8fbff; border-radius: 10px; box-shadow: 0 1px 6px #b6e0fe33; padding: 0.7rem; display: flex; flex-direction: column; align-items: center; position: relative; }
    .gallery-item img, .gallery-item video { width: 100%; max-height: 120px; object-fit: cover; border-radius: 8px; margin-bottom: 0.5rem; }
    .delete-btn { background: #e53935; color: #fff; border: none; border-radius: 6px; padding: 0.3rem 1.1rem; font-size: 0.98rem; font-weight: 700; cursor: pointer; position: absolute; top: 8px; right: 8px; transition: background 0.18s; }
    .delete-btn:hover { background: #b71c1c; }
    .filename { font-size: 0.95rem; color: #134b70; word-break: break-all; text-align: center; }
    @media (max-width: 600px) { .admin-container { padding: 1rem 0.3rem; } .gallery-list { grid-template-columns: 1fr 1fr; } }
  </style>
</head>
<body>
  <div class="admin-container">
    <h1>Gallery Control Panel</h1>
    <form class="upload-form" id="uploadForm">
      <input type="file" id="fileInput" name="files" multiple accept="image/*,video/*">
      <button type="submit">Upload</button>
    </form>
    <div class="gallery-list" id="galleryList"></div>
  </div>
  <script>
    async function fetchFiles() {
      const res = await fetch('/api/files');
      const files = await res.json();
      const list = document.getElementById('galleryList');
      list.innerHTML = '';
      files.forEach(file => {
        const ext = file.split('.').pop().toLowerCase();
        const item = document.createElement('div');
        item.className = 'gallery-item';
        if (["jpg","jpeg","png","gif","webp"].includes(ext)) {
          item.innerHTML = `<img src="photes/${file}" alt="gallery image">`;
        } else if (["mp4","webm","ogg"].includes(ext)) {
          item.innerHTML = `<video src="photes/${file}" controls></video>`;
        }
        item.innerHTML += `<div class='filename'>${file}</div>`;
        const delBtn = document.createElement('button');
        delBtn.className = 'delete-btn';
        delBtn.textContent = 'Delete';
        delBtn.onclick = async () => {
          if (confirm('Are you sure you want to delete this file?')) {
            await fetch(`/api/files/${encodeURIComponent(file)}`, { method: 'DELETE' });
            fetchFiles();
          }
        };
        item.appendChild(delBtn);
        list.appendChild(item);
      });
    }
    document.getElementById('uploadForm').onsubmit = async e => {
      e.preventDefault();
      const input = document.getElementById('fileInput');
      if (!input.files.length) return;
      const formData = new FormData();
      for (const file of input.files) formData.append('files', file);
      await fetch('/api/upload', { method: 'POST', body: formData });
      input.value = '';
      fetchFiles();
    };
    fetchFiles();
  </script>
</body>
</html> 